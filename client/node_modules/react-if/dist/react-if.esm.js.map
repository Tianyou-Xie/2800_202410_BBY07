{"version":3,"file":"react-if.esm.js","sources":["../src/render.tsx","../src/Case.tsx","../src/Default.tsx","../src/Else.tsx","../src/Fallback.tsx","../src/getConditionResults.ts","../src/isThenable.ts","../src/utils.ts","../src/hooks.ts","../src/Then.tsx","../src/IfAsync.tsx","../src/tinyWarning.ts","../src/If.tsx","../src/Switch.tsx","../src/Unless.tsx","../src/When.tsx"],"sourcesContent":["import React, { Fragment } from 'react';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * Renders a React component while also checking whether the children are a function or not\n * @param props Props of the component to render\n */\nexport const render: FCWithImplicitChildren = (props) => {\n  if (typeof props.children === 'function') {\n    return <Fragment>{props.children()}</Fragment>;\n  }\n\n  return <Fragment>{props.children || null}</Fragment>;\n};\n","import type { FC } from 'react';\nimport { render } from './render';\nimport type { ComponentWithConditionPropsWithFunctionChildren } from './types';\n\n/**\n * If the `<Case />` is the first one to have its condition evaluates to true\n * inside the parent `<Switch />` it will be the only rendered.\n * @param props The props to pass down to the `<Case />` component\n */\nexport const Case: FC<ComponentWithConditionPropsWithFunctionChildren> = ({ children = null }) => {\n  return render({ children });\n};\n","import { render } from './render';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * If no `<Case />` have its condition evaluates to true inside the parent `<Switch />`,\n * the first `<Default />` will be the only one rendered.\n * @param props The props to pass down to the `<Default />` component\n */\nexport const Default: FCWithImplicitChildren = ({ children = null }) => {\n  return render({ children });\n};\n","import { render } from './render';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * Must only contain a single child, which it renders as-is.\n * Should not be used outside of an `<If />` block.\n * @param props The props to pass down to the `<Else />` component\n */\nexport const Else: FCWithImplicitChildren = (props) => render(props);\n","import { render } from './render';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * Must contain only a single child, which it renders as-is.\n * Should not be used outside of an `<If />` block whose condition prop is a promise.\n * @param props The props to pass down to the `<Fallback />` component\n */\nexport const Fallback: FCWithImplicitChildren = (props) => render(props);\n","import type { BooleanLike } from './types';\n\n/**\n * Resolves a condition that is {@link BooleanLike} or returns {@link BooleanLike} from a function\n * @param condition The condition to resolve\n */\nexport const getConditionResult = (condition: BooleanLike | ((...args: unknown[]) => BooleanLike)): boolean => {\n  const conditionResult = Boolean(typeof condition === 'function' ? condition() : condition);\n\n  return conditionResult;\n};\n","/**\n * The MIT License (MIT)\n *\n * Copyright Â© `2020` `The Sapphire Community and its contributors`\n *\n * Source: https://github.com/sapphiredev/utilities/blob/main/packages/utilities/src/lib/isThenable.ts\n * Full license: https://github.com/sapphiredev/utilities/blob/main/LICENSE.md\n */\n\n/* eslint-disable @typescript-eslint/ban-types */\n\ninterface Thenable {\n  then: Function;\n  catch: Function;\n}\n\n/**\n * Verify if the input is a function.\n * @param input The function to verify\n */\n\nexport function isFunction(input: unknown): input is Function {\n  return typeof input === 'function';\n}\n\nfunction hasThen(input: { then?: Function }): boolean {\n  return Reflect.has(input, 'then') && isFunction(input.then);\n}\n\nfunction hasCatch(input: { catch?: Function }): boolean {\n  return Reflect.has(input, 'catch') && isFunction(input.catch);\n}\n\n/**\n * Verify if an object is a promise.\n * @param input The promise to verify\n */\nexport function isThenable(input: unknown): input is Thenable {\n  if (typeof input !== 'object' || input === null) return false;\n  return input instanceof Promise || (input !== Promise.prototype && hasThen(input) && hasCatch(input));\n}\n","import { isThenable } from './isThenable';\nimport type { CancellablePromise, ExtendablePromise } from './types';\n\n/**\n * Compare two arrays without checking for possible nested properties\n * @param a Array to compare with b\n * @param b Array to compare with a\n * @returns True if arrays are identical, false if they are different\n */\nexport const shallowArraysEqual = (a: any[], b: any[]): boolean => {\n  if (!Array.isArray(a) || !Array.isArray(b)) throw new Error('shallowArraysEqual only accepts arrays as parameters');\n  if (a.length !== b.length) return false;\n\n  for (let i = 0; i < a.length; ++i) {\n    if (a[i] !== b[i]) return false;\n  }\n  return true;\n};\n\n/**\n * Create a CancellablePromise from a native Promise\n * @param promise The promise object to wrap\n * @returns Return value is an object of type CancellablePromise, with 2 properties:\n * - promise: a promise that can be left pending\n * - cancel: the function to use for cancelling the returned promise\n */\nexport const createCancellablePromise = <T>(promise: ExtendablePromise<T>): CancellablePromise => {\n  if (!isThenable(promise)) {\n    throw new Error('Argument of createCancellablePromise should be a Promise');\n  }\n\n  const isCancelled = { value: false };\n\n  const wrappedPromise: ExtendablePromise<T> = new Promise(async (res, rej) => {\n    try {\n      const d = await promise;\n      return !isCancelled.value && res(d);\n    } catch (error) {\n      !isCancelled.value && rej(error);\n    }\n  });\n\n  // Forward potential additional properties\n  Object.keys(promise).forEach((key) => {\n    wrappedPromise[key] = promise[key];\n  });\n\n  return {\n    promise: wrappedPromise,\n    cancel: () => {\n      isCancelled.value = true;\n    }\n  };\n};\n","import { useRef } from 'react';\nimport { shallowArraysEqual } from './utils';\n\n/**\n * Calls a function only once during component lifecycle;\n * When dependency array is provided, will call the function again if at least one of the dependencies changed\n * @param callback The function to execute only once\n * @param dependencies A list of dependencies whose value, if changed since last call,\n * will trigger the execution of the callback\n */\nexport const useSingleton = (callback: () => any, dependencies: any[] = []) => {\n  const hasRan = useRef<boolean>(false);\n  const lastDependencies = useRef<any[]>([]);\n\n  // Parameters type check\n  if (typeof callback !== 'function') {\n    throw new Error(`Incorrect callback parameter for useSingleton hook; expected a function, but got: '${typeof callback}'.`);\n  }\n  if (!Array.isArray(dependencies)) {\n    throw new Error(`Incorrect dependencies parameter for useSingleton; expected an array, but got: '${typeof dependencies}'.`);\n  }\n\n  const hasDependencies = Array.isArray(dependencies) && dependencies.length > 0;\n  if (hasDependencies) {\n    // Has dependencies\n    const hasAnyDependencyChanged = !shallowArraysEqual(lastDependencies.current, dependencies);\n    if (hasAnyDependencyChanged) {\n      // Any dep has changed => overwrite last dependencies and execute callback\n      lastDependencies.current = dependencies;\n    } else if (hasRan.current) {\n      // No dep has changed => same behaviour as if no dependencies\n      return;\n    }\n  } else if (hasRan.current) {\n    // No dependencies\n    return;\n  }\n\n  callback();\n  hasRan.current = true;\n};\n","import { render } from './render';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * Must contain only a single child, which it renders as-is.\n * Should not be used outside of an `<If />` block.\n * @param props The props to pass down to the `<Then />` component\n */\nexport const Then: FCWithImplicitChildren = (props) => render(props);\n","import React, { Fragment, useEffect, useMemo, useRef, useState, PropsWithChildren, ReactElement } from 'react';\nimport { Else } from './Else';\nimport { Fallback } from './Fallback';\nimport { useSingleton } from './hooks';\nimport { isThenable } from './isThenable';\nimport { Then } from './Then';\nimport type { AsyncSupportProps, CancellablePromise, ExtendablePromise } from './types';\nimport { createCancellablePromise } from './utils';\n\n/**\n * Props for IfAsync\n */\ninterface Props<T> extends AsyncSupportProps, PropsWithChildren<{ promise: ExtendablePromise<T> }> {}\n\n/**\n * Is included in the `<If />` component, rendered when the condition prop of `<If />` is a Promise;\n * Renders the Fallback component, if contains any, until provided promise is fulfilled;\n * Renders `<Then />` when promise is fulfilled, `<Else />` when rejected\n */\n\nexport function IfAsync<T = any>({ promise, keepAlive = false, children }: Props<T>) {\n  const [isResolved, setIsResolved] = useState<null | boolean>(null);\n  const [returnValue, setReturnValue] = useState(null);\n\n  // Make promise cancellable\n  const cancellablePromise = useMemo((): CancellablePromise => createCancellablePromise(promise), [promise]);\n  const history = useRef<CancellablePromise[]>([]); // Keep history of promises\n\n  // Handle unmount\n  useEffect(() => {\n    return () => {\n      if (!keepAlive) {\n        cancellablePromise.cancel();\n      }\n    };\n  }, [cancellablePromise, cancellablePromise.promise, keepAlive]);\n\n  // Await promise\n  useSingleton(async () => {\n    setIsResolved(null);\n    setReturnValue(null);\n\n    try {\n      const data = await cancellablePromise.promise;\n      setReturnValue(data);\n      setIsResolved(true);\n      history.current.push(cancellablePromise);\n    } catch (error) {\n      setReturnValue(error as any);\n      setIsResolved(false);\n      history.current.push(cancellablePromise);\n    }\n  }, [cancellablePromise.promise]);\n\n  if (!children || !isThenable(promise)) {\n    return null;\n  }\n\n  if (isResolved === null) {\n    // Promise is pending\n    const hasFallback = (React.Children.toArray(children) as ReactElement[]).find((c) => c.type === Fallback);\n    return <Fragment>{hasFallback || null}</Fragment>;\n  }\n\n  if (!isResolved) {\n    // Promise is fulfilled and rejected\n    const hasElse = (React.Children.toArray(children) as ReactElement[]).find((c) => c.type === Else);\n    if (!hasElse) return <Fragment>{null}</Fragment>;\n\n    // Inject caught error\n    let elseElement = hasElse;\n    if (typeof hasElse.props.children === 'function') {\n      elseElement = {\n        ...hasElse,\n        props: {\n          ...hasElse.props,\n          children: () => hasElse.props.children(returnValue, history.current, cancellablePromise.promise)\n        }\n      };\n    }\n    return <Fragment>{elseElement}</Fragment>;\n  }\n\n  // Promise is fulfilled and resolved\n  const hasThen = (React.Children.toArray(children) as ReactElement[]).find((c) => c.type === Then);\n  if (!hasThen) return <Fragment>{null}</Fragment>;\n\n  // Inject promise return value\n  let thenElement = hasThen;\n\n  if (typeof hasThen.props.children === 'function') {\n    thenElement = {\n      ...hasThen,\n      props: {\n        ...hasThen.props,\n        children: () => hasThen.props.children(returnValue, history.current, cancellablePromise.promise)\n      }\n    };\n  }\n\n  return <Fragment>{thenElement}</Fragment>;\n}\n","/**\n * Handles errors by throwing them to the console.\n * `__DEV__` is replaced by dts-cli using {@link https://www.npmjs.com/package/babel-plugin-dev-expression babel-plugin-dev-expressions}\n * which will ensure this entire throw is not present in production\n * @param condition The condition to check\n * @param message The message to throw if `condition` resolves to `true`\n */\nexport function tinyWarning(condition: boolean, message: string): asserts condition {\n  if (__DEV__) {\n    if (condition) {\n      // check console for IE9 support which provides console\n      // only with open devtools\n\n      if (typeof console !== 'undefined') {\n        console.warn(message);\n      }\n\n      // Throwing an error and catching it immediately to improve debugging\n      // Users can utilize 'pause on caught exceptions' to get into this throw\n      try {\n        throw new Error(message);\n      } catch (x) {\n        // noop\n      }\n    }\n  }\n}\n\ndeclare global {\n  let __DEV__: boolean;\n}\n","import React, { FC, Fragment, ReactElement } from 'react';\nimport { Else } from './Else';\nimport { Fallback } from './Fallback';\nimport { getConditionResult } from './getConditionResults';\nimport { IfAsync } from './IfAsync';\nimport { isThenable } from './isThenable';\nimport { Then } from './Then';\nimport { tinyWarning } from './tinyWarning';\nimport type { ComponentWithConditionPropsAsyncSupport, ExtendablePromise } from './types';\n\n/**\n * If condition evaluates to true, renders the `<Then />` block will be rendered,\n * otherwise renders the `<Else />` block. Either block may be omitted.\n *\n * This component can contain any number of `<Then />` or `<Else />` blocks,\n * but only the first block of the right type (either Then or Else, depending on the condition) will be rendered.\n * @param __namedParameters The props to pass down to the `<IF />` component, see {@link ComponentWithConditionProps}\n */\nexport const If: FC<ComponentWithConditionPropsAsyncSupport> = ({ condition, keepAlive = false, children }) => {\n  if (!children) {\n    return null;\n  }\n\n  tinyWarning(\n    (!Array.isArray(children) && !((children as ReactElement).type === Else || (children as ReactElement).type === Then)) ||\n      !(React.Children.toArray(children) as ReactElement[]).every((child) => child.type === Else || child.type === Then || child.type === Fallback),\n    'The <If> component should contain <Then /> <Else /> or <Fallback /> components as its children'\n  );\n\n  if (isThenable(condition)) {\n    return (\n      <IfAsync promise={condition as ExtendablePromise<any>} keepAlive={keepAlive}>\n        {children}\n      </IfAsync>\n    );\n  }\n\n  const conditionResult = getConditionResult(condition);\n\n  return <Fragment>{(React.Children.toArray(children) as ReactElement[]).find((c) => (c.type !== Else) !== !conditionResult) || null}</Fragment>;\n};\n","import React, { ReactElement } from 'react';\nimport { Case } from './Case';\nimport { Default } from './Default';\nimport { getConditionResult } from './getConditionResults';\nimport { isFunction } from './isThenable';\nimport type { FCWithImplicitChildren } from './types';\n\n/**\n * It will render the first matching `<Case />`, or the first encountered `<Default />` (or `null`).\n *\n * This component can contain any number of `<Case />` and one `<Default />` blocks\n * @param __namedParameters Children to pass into the `<Switch />` component\n */\nexport const Switch: FCWithImplicitChildren = ({ children }) => {\n  // -- Inspired by react-router --\n\n  // We use React.Children.forEach instead of React.Children.toArray().find()\n  // here because toArray adds keys to all child elements and we do not want\n  // to trigger an unmount/remount for two children <Case>s or <Default>s\n  let matchingCase: ReactElement | undefined = undefined;\n  let defaultCase: ReactElement | undefined = undefined;\n\n  // If the children are a function then resolve it first\n  if (isFunction(children)) {\n    children = children();\n  }\n\n  React.Children.forEach(children, (child) => {\n    // not a valid react child, don't add it\n    /* istanbul ignore next - This is only a safe fail for people writing bad code */\n    if (!React.isValidElement(child)) {\n      return;\n    }\n\n    if (!matchingCase && child.type === Case) {\n      const { condition } = child.props;\n\n      const conditionResult = getConditionResult(condition);\n\n      if (conditionResult) {\n        matchingCase = child;\n      } // else not matching condition, don't add it\n    } else if (!defaultCase && child.type === Default) {\n      defaultCase = child;\n    } // else unknown type, don't add it\n  });\n\n  return matchingCase ?? defaultCase ?? null;\n};\n","import type { FC } from 'react';\nimport { getConditionResult } from './getConditionResults';\nimport { render } from './render';\nimport type { ComponentWithConditionPropsWithFunctionChildren } from './types';\n\n/** A shorthand for\n *\n * ```jsx\n * <If condition={...}>\n *     <Else>\n *         { ... }\n *     </Else>\n * </If>\n * ```\n *\n * The same rules apply to the child elements as with using the `<Else />` block.\n *\n * @param __namedParameters The props to pass down to the `<IF />` component, see {@link ComponentWithConditionProps}\n */\nexport const Unless: FC<ComponentWithConditionPropsWithFunctionChildren> = ({ condition, children = null }) => {\n  const conditionResult = Boolean(getConditionResult(condition));\n\n  return !conditionResult && children ? render({ children }) : null;\n};\n","import type { FC } from 'react';\nimport { getConditionResult } from './getConditionResults';\nimport { render } from './render';\nimport type { ComponentWithConditionPropsWithFunctionChildren } from './types';\n\n/** A shorthand for\n *\n * ```jsx\n * <If condition={...}>\n *     <Then>\n *         { ... }\n *     </Then>\n * </If>\n * ```\n *\n * The same rules apply to the child elements as with using the `<Then /`> block.\n *\n * @param __namedParameters The props to pass down to the `<IF />` component, see {@link ComponentWithConditionProps}\n */\nexport const When: FC<ComponentWithConditionPropsWithFunctionChildren> = ({ condition, children = null }) => {\n  const conditionResult = Boolean(getConditionResult(condition));\n\n  return conditionResult && children ? render({ children }) : null;\n};\n"],"names":["render","props","children","React","createElement","Fragment","Case","_ref","_ref$children","Default","Else","Fallback","getConditionResult","condition","conditionResult","Boolean","isFunction","input","hasThen","Reflect","has","then","hasCatch","isThenable","Promise","prototype","shallowArraysEqual","a","b","Array","isArray","Error","length","i","createCancellablePromise","promise","isCancelled","value","wrappedPromise","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","rej","d","wrap","_callee$","_context","prev","next","sent","abrupt","t0","stop","_x","_x2","apply","arguments","Object","keys","forEach","key","cancel","useSingleton","callback","dependencies","hasRan","useRef","lastDependencies","hasDependencies","hasAnyDependencyChanged","current","Then","IfAsync","_ref$keepAlive","keepAlive","_useState","useState","isResolved","setIsResolved","_useState2","returnValue","setReturnValue","cancellablePromise","useMemo","history","useEffect","data","push","hasFallback","Children","toArray","find","c","type","hasElse","elseElement","_extends","thenElement","tinyWarning","message","process","env","NODE_ENV","console","warn","x","If","every","child","Switch","_ref2","_matchingCase","matchingCase","undefined","defaultCase","isValidElement","Unless","When"],"mappings":"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"}